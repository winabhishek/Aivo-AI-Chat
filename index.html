<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aivo - AI Chat Application</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chat-bubble-user {
            background-color: #3b82f6;
            color: white;
        }
        .chat-bubble-ai {
            background-color: #e5e7eb;
            color: #1f2937;
        }
        .chat-container::-webkit-scrollbar {
            width: 6px;
        }
        .chat-container::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .chat-container::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 3px;
        }
    </style>
    <!-- Chosen Palette: Tailwind's Slate and Blue -->
    <!-- Application Structure Plan: A single-page chat application. The user is first prompted for their Google API Key. Once provided, the main chat interface is unlocked. This structure was chosen to directly replicate the user's original goal (a Gemini chatbot) in a self-contained, browser-only format, eliminating all server-side dependencies and installation issues the user was facing. The flow is simple: Key -> Chat. -->
    <!-- Visualization & Content Choices: The source "report" is a chatbot project. The primary goal is to facilitate a text-based conversation with an AI. Therefore, the chosen presentation is a familiar chat interface with distinct bubbles for the user and the AI. This is built with simple HTML and styled with Tailwind CSS. Interaction is handled via a standard chat input form. All logic, including the `fetch` call to the Google Gemini API (using the modern 'gemini-1.5-flash' model), is managed by vanilla JavaScript within the same HTML file. No charts or complex visualizations are needed. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-100 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl bg-white rounded-2xl shadow-2xl flex flex-col h-[90vh]">
        <header class="p-4 border-b bg-slate-50 rounded-t-2xl">
            <h1 class="text-2xl font-bold text-slate-800 text-center">ðŸ‘¾ Aivo AI Chat</h1>
        </header>

        <div id="api-key-section" class="p-6 flex flex-col gap-4 items-center justify-center h-full">
            <h2 class="text-xl font-semibold text-slate-700">Shuru karne ke liye API Key Daalein</h2>
            <p class="text-slate-500 text-center">Apna Google Gemini API Key neeche paste karein.</p>
            <input type="password" id="api-key-input" class="w-full max-w-md p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="Apni API Key yahan paste karein...">
            <button id="api-key-submit" class="w-full max-w-md bg-blue-500 text-white font-semibold py-3 rounded-lg hover:bg-blue-600 transition-colors">API Key Set Karein</button>
            <p class="text-xs text-slate-400 mt-2">Aapki API key browser mein hi rehti hai aur kahin save nahi hoti.</p>
             <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-sm text-blue-600 hover:underline">Yahan se apni API Key prapt karein</a>
        </div>

        <main id="chat-section" class="hidden flex-1 flex flex-col">
            <div id="chat-container" class="flex-1 p-6 overflow-y-auto chat-container">
                <!-- Chat messages will be appended here -->
                <div class="flex justify-start mb-4">
                    <div class="chat-bubble-ai py-2 px-4 rounded-lg max-w-xs md:max-w-md">
                        Namaste! Main Aivo hoon. Aap sidebar se API key daal kar mujhse baat kar sakte hain.
                    </div>
                </div>
            </div>

            <div class="p-4 bg-white border-t rounded-b-2xl">
                <form id="chat-form" class="flex items-center gap-3">
                    <input type="text" id="chat-input" class="flex-1 p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="Apna sawaal yahan likhein..." autocomplete="off" disabled>
                    <button type="submit" id="send-button" class="bg-blue-500 text-white p-3 rounded-lg hover:bg-blue-600 disabled:bg-slate-400 disabled:cursor-not-allowed" disabled>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.428A1 1 0 009.894 15V4.106A1 1 0 0010.894 2.553z" />
                            <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.428A1 1 0 009.894 15V4.106A1 1 0 0010.894 2.553z" />
                        </svg>
                    </button>
                </form>
            </div>
        </main>
    </div>

    <script>
        const apiKeySection = document.getElementById('api-key-section');
        const chatSection = document.getElementById('chat-section');
        const apiKeyInput = document.getElementById('api-key-input');
        const apiKeySubmitBtn = document.getElementById('api-key-submit');
        
        const chatContainer = document.getElementById('chat-container');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');

        let apiKey = '';

        apiKeySubmitBtn.addEventListener('click', () => {
            const key = apiKeyInput.value.trim();
            if (key) {
                apiKey = key;
                apiKeySection.classList.add('hidden');
                chatSection.classList.remove('hidden');
                chatSection.classList.add('flex');
                chatInput.disabled = false;
                sendButton.disabled = false;
                addMessageToUI('Namaste! Main Aivo hoon. Ab aap mujhse kuch bhi pooch sakte hain.', 'ai');
            } else {
                alert('Kripya ek valid API key daalein.');
            }
        });
        
        chatForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const userMessage = chatInput.value.trim();
            if (userMessage) {
                addMessageToUI(userMessage, 'user');
                chatInput.value = '';
                fetchAiResponse(userMessage);
            }
        });

        function addMessageToUI(message, sender) {
            const messageWrapper = document.createElement('div');
            const messageBubble = document.createElement('div');
            
            messageWrapper.classList.add('flex', 'mb-4');
            messageBubble.classList.add('py-2', 'px-4', 'rounded-lg', 'max-w-xs', 'md:max-w-md', 'break-words');

            if (sender === 'user') {
                messageWrapper.classList.add('justify-end');
                messageBubble.classList.add('chat-bubble-user');
            } else {
                messageWrapper.classList.add('justify-start');
                messageBubble.classList.add('chat-bubble-ai');
            }
            
            messageBubble.textContent = message;
            messageWrapper.appendChild(messageBubble);
            chatContainer.appendChild(messageWrapper);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        async function fetchAiResponse(prompt) {
            sendButton.disabled = true;
            chatInput.placeholder = 'AI soch raha hai...';

            const loadingBubble = document.createElement('div');
            loadingBubble.classList.add('flex', 'justify-start', 'mb-4');
            loadingBubble.innerHTML = `
                <div class="chat-bubble-ai py-2 px-4 rounded-lg">
                    <div class="flex items-center space-x-2">
                        <div class="w-2 h-2 rounded-full bg-slate-400 animate-pulse"></div>
                        <div class="w-2 h-2 rounded-full bg-slate-400 animate-pulse" style="animation-delay: 0.2s;"></div>
                        <div class="w-2 h-2 rounded-full bg-slate-400 animate-pulse" style="animation-delay: 0.4s;"></div>
                    </div>
                </div>
            `;
            chatContainer.appendChild(loadingBubble);
            chatContainer.scrollTop = chatContainer.scrollHeight;

            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }]
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error.message || 'API se response nahi mila.');
                }

                const data = await response.json();
                const aiResponse = data.candidates[0].content.parts[0].text;
                
                chatContainer.removeChild(loadingBubble);
                addMessageToUI(aiResponse, 'ai');

            } catch (error) {
                chatContainer.removeChild(loadingBubble);
                addMessageToUI(`Ek error aa gaya: ${error.message}. Kripya apni API key jaanchein aur dobara koshish karein.`, 'ai');
            } finally {
                sendButton.disabled = false;
                chatInput.placeholder = 'Apna sawaal yahan likhein...';
            }
        }
    </script>
</body>
</html>
